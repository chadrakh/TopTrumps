@model IEnumerable<TopTrumpsNovus.Models.Card>

@{
    ViewData["Title"] = "Index"; 
    int deckID = 1;
    List<Card> cardList = new List<Card>();
    List<Card> drawnCardsList = new List<Card>();
}

<div class= "Game">

    @{
        foreach (var item in Model)
        {
            if ((item.DeckID) == deckID)
            {
                cardList.Add(item);
            }
        }

        ColumnNames cns = new ColumnNames();

        string[] columnNames = cns.getColumnNames(deckID);

        Random rng = new Random();
        cardList = cardList.OrderBy(a => rng.Next()).ToList();

        List<Card> playersCards = new List<Card>();
        List<Card> aisCards = new List<Card>();

        int halfOfDeck = (cardList.Count() / 2);

        for (int i = 0; i < halfOfDeck;i++)
        {
            playersCards.Add(cardList.ElementAt(i));
        }

        for (int i = halfOfDeck; i < cardList.Count(); i++)
        {
            aisCards.Add(cardList.ElementAt(i));
        }

        <div class="Cards">

            <div class="CardStyle">
                <div>
                    <div>
                        <p class="cardInfo-title">
                            @Html.DisplayFor(modelItem => playersCards.ElementAt(0).CardName)
                        </p>
                    </div>
                    <img src=playersCards.ElementAt(0).ImageFilePath>
                    <div>
                        <p class="statOne">
                            @columnNames[0] <span class="statOne-value">@Html.DisplayFor(modelItem => playersCards.ElementAt(0).StatOne)</span>
                            <button type="button" class="selectStatBtn" onclick="handleStatSelected('statOne')">SELECT</button>
                        </p>
                    </div>
                    <div>
                        <p class="statTwo">
                            @columnNames[1] @Html.DisplayFor(modelItem => playersCards.ElementAt(0).StatTwo)
                        </p>
                    </div>
                    <div>
                        <p class="statThree">
                            @columnNames[2] @Html.DisplayFor(modelItem => playersCards.ElementAt(0).StatThree)
                        </p>
                    </div>
                    <div>
                        <p class="statFour">
                            @columnNames[3] @Html.DisplayFor(modelItem => playersCards.ElementAt(0).StatFour)
                        </p>
                    </div>
                    <div>
                        <p class="statFive">
                            @columnNames[4] @Html.DisplayFor(modelItem => playersCards.ElementAt(0).StatFive)
                        </p>
                    </div>
                    <div>
                        <p class="statSix">
                            @columnNames[5] @Html.DisplayFor(modelItem => playersCards.ElementAt(0).StatSix)
                        </p>
                    </div>
                </div>
            </div>

            <div class="CardStyle">
                <div>
                    <div>
                        <p class="aiCard-title">
                            @Html.DisplayFor(modelItem => playersCards.ElementAt(1).CardName)
                        </p>
                    </div>
                    <img src=playersCards.ElementAt(0).ImageFilePath>
                    <div>
                        <p class="aiCard-statOne">
                            @columnNames[0] @Html.DisplayFor(modelItem => playersCards.ElementAt(1).StatOne)
                        </p>
                    </div>
                    <div>
                        <p class="aiCard-statTwo">
                            @columnNames[1] @Html.DisplayFor(modelItem => playersCards.ElementAt(1).StatTwo)
                        </p>
                    </div>
                    <div>
                        <p class="aiCard-statThree">
                            @columnNames[2] @Html.DisplayFor(modelItem => playersCards.ElementAt(1).StatThree)
                        </p>
                    </div>
                    <div>
                        <p class="aiCard-statFour">
                            @columnNames[3] @Html.DisplayFor(modelItem => playersCards.ElementAt(1).StatFour)
                        </p>
                    </div>
                    <div>
                        <p class="aiCard-statFive">
                            @columnNames[4] @Html.DisplayFor(modelItem => playersCards.ElementAt(1).StatFive)
                        </p>
                    </div>
                    <div>
                        <p class="aiCard-statSix">
                            @columnNames[5] @Html.DisplayFor(modelItem => playersCards.ElementAt(1).StatSix)
                        </p>
                    </div>
                </div>
            </div>
        
        </div>



        
}
</div>

<script type="text/javascript">
    const cardsArr = @Html.Raw(Json.Serialize(playersCards));

    const handleStatSelected = (statRef) => {
        const elementValue = document.querySelector(`.${statRef}`).innerText;
        const statHeader = elementValue.split` `[0];
        const playerStatValue = elementValue.split` `[1];

        console.log(`statHeader: ${statHeader}`);
        console.log(`player-statValue: ${playerStatValue}`);

        getAiStat(statRef, playerStatValue);
    }

    const getAiStat = (statRef, playerStatValue) => {
        const elementValue = document.querySelector(`.aiCard-${statRef}`).innerText;
        const aiStatValue = elementValue.split` `[1];

        console.log(`ai-statValue: ${aiStatValue}`);

        compareStats(playerStatValue, aiStatValue);

        return aiStatValue;
    }

    let roundCount = 0;

    const compareStats = (playerStatValue, aiStatValue) => {
        let notification;
        const title = `Round ${roundCount}`;
        const delay = 2000;

        roundCount++;

        if (playerStatValue > aiStatValue) {
            alert(`Player wins Round ${roundCount}!`)
        } else if (aiStatValue > playerStatValue) {
            alert(`Computer wins Round ${roundCount}!`)
        } else {
            alert(`Round ${roundCount}: it's a tie!`)
        }

        const indexToRemove = cardsArr.indexOf(cardsArr[0]);
        console.log(cardsArr.indexOf(cardsArr[0]));
        cardsArr.splice(indexToRemove, 1);

        console.log(cardsArr);
        updateCards();
    }

    const updateCards = () => {
        
    }
</script>
